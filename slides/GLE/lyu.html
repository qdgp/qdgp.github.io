<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<title>comprehensve exam</title>
		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/serif.css">
		<style>	
		div.model {
			display: flex;
			justify-content: space-between;
			align-items: center; /* This will vertically center the content */
			margin: 20px 0;
			padding: 10px;
			border: 1px solid #ddd;
			border-radius: 5px;
		}
		div.model .name {
			margin: 0;
			flex: 1;
			color: #444;
			display: flex;
			align-items: center; /* This will vertically center the text */
			justify-content: flex-end; /* This will align the text to the right */
			padding-right: 20px; /* Some spacing between the name and the equation */
		}
		div.model .equation {
			flex: 2;
		}
			figcaption {
			  color: black;
			  font-style: italic;
			  padding: 2px;
			  font-size:large;
			  text-align: center;
			}
			.particle {
				fill: blue;
				stroke: black;
				stroke-width: 1;
			}
			.bond {
				stroke: black;
				stroke-width: 2;
			}
			cite {
				font-size: 0.4em; /* Adjust the font size as needed */
				display: block; /* Optional: To make the citation appear on a new line */
				color:#444
			}
			.theorem, .proposition {
				border: 1px solid #000;
				padding: 10px;
				margin: 10px 0;
			}
			.theorem {
				background-color: #f0f0f0;
			}
			.proposition {
				background-color: #e0e0e0;
			}
			.theorem h4, .proposition h4 {
				margin: 0;
				font-size: 1em;
			}
			.content {
				margin-top: 5px;
				font-size: 0.6em;
			}
		</style>
		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css">
		<script src="https://d3js.org/d3.v5.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script>
		<script type="text/x-mathjax-config">
			MathJax.Hub.Config({
			  TeX: {
				Macros: {
					bm: ["{\\mathbf{#1}}", 1],
					mb: ["{\\mathbf{#1}}", 1],
			   diff: "\\mathop{}\\!\\mathrm{d}",
			   MLMN: "\\mathcal{L}_\\mathcal{N}",
			   bz: "\\mathbf{z}",
			   br: "\\mathbf{r}",
			   bs: "\\mathbf{s}",
			   bF: "\\mathbf{F}",
			   intd: "\\mathrm{d}",
			   mbm:"\\mathbf{m}",
				}
			  }
			});
		  </script>
		<script type="text/javascript">
		window.PlotlyConfig = {MathJaxConfig: 'local'};
		</script>
		<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
		<script src="./figure/md.js"></script>

	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<div style="text-align: center;">
						<h4>
							Integration of deep learning technology in the construction of multiscale models
						</h4>
					</div>
					<div style="margin-left: auto; text-align: left; font-size: 0.7em;">
						<p>
							lyuliyao <br>
							Department of Computational Mathematics, Science & Engineering <br>
							Michigan State University
						</p>
					</div>
					<aside class="notes">
						Today, I’m going to explore how we can integrate deep learning technology to enhance the construction of multiscale models.
					</aside>
                </section>
				<section data-auto-animate data-menu-title="Multi-scale modeling:Background">
					<h4>
						<div style="display:inline">
							Multi-scale modeling:
						</div> 
						<div style="display:inline">
							Background 
						</div>
					</h4>
					<div style="display: flex; align-items: center; justify-content: center; width: 100%;">
						<div>
							<figure style="margin-right: 5%;">
								<img src="./figure/Dirac.png" style="width:70%" alt="Eiffel tower">
							</figure>
							<cite>
								Dirac, Paul Adrien Maurice. "Quantum mechanics of many-electron systems." Proceedings of the Royal Society of London. 1929.
							</cite>
						</div>
						<div align="left">
							<small>
								The right physical principle for most of what we are interested in is already provided by the principles of quantum mechanics (QM), there is no need to look further. <br>
							</small>
						</div>
					</div>
				</section>
				
				<section data-auto-animate>
					<h4>
						<div data-id="suptitle" style="display:inline">
							Multi-scale modeling:
						</div> 
						<div style="display:inline">
							Background 
						</div>
					</h4>
					<div style="display: flex; justify-content: center; align-items: center;">

						<div>
							<div align="left">
								<small>
									The constructionist hypothesis breaks
									down when confronted with <font color="#C82423">the twin
									difficulties of scale and complexity.</font> The
									behavior of large and complex aggregates of elementary particles, it turns
									out, is not to be understood in terms
									of a simple extrapolation of the properties of a few particles. Instead, at
									each level of complexity entirely new
									properties appear, and the understanding of the new behaviors requires research which I think is as fundamental
									in its nature as any other.
								</small>
							</div>
							<div style="font-size: 0.6em;">
								<br>
								<font color="#C82423">Scale - High Dimensionality - Curse of Dimensionality </font> <br>
								<font color="#C82423">Complexity - Empirical Model - Oversimplification</font>
							</div>
						</div>
						<div>
							<figure>
								<p><img src="./figure/Andersonphoto-removebg.png"
									style="width:2000px; object-fit: cover;"
									alt="Eiffel tower">
								</p>
							</figure>
							<cite>
								Anderson, Philip W. "More Is Different: Broken symmetry and the nature of the hierarchical structure of science." Science 177.4047 (1972): 393-396.
							</cite>
						</div>
					</div>

					<aside class="notes">
						However, the ability to reduce everything to simple fundamental laws does not imply the ability to start from those laws and reconstruct the universe.
						<br>
						This intricate challenge remained largely ignored until Anderson underscored, that the constructivist hypothesis falters when faced with the challenges of scale and complexity.
					</aside>
				</section>
				<section data-auto-animate>
					<h4>
						Free Energy Surface
					</h4>
					<div style="display: flex; justify-content: center; align-items: center;">
					<div>
						<small>
							\[
							\begin{aligned}
							& \text{FES}:& & A(\bz)  =  -\frac{1}{\beta}\ln \rho(\bz)\\
							& \text{CVs}:& & \bz = \bs(\br)\\
							& \text{PDF}:& & \rho(\bz) =  \frac{\int e^{(-\beta U(\br))} \delta(\bs(\br)-\bz) \intd \br}{Z}\\
							& \text{Potential}:  & &U(\br)   \text{ of the micro-scale coordinates } \br \\
							\end{aligned}
							\]
						</small>
					</div>
					<div>
						<figure>
							<p>
								<img  style="width:80%" src="./figure/FES.png">
							</p>
						</figure>
						<cite>
							Dill, Ken A., and Justin L. MacCallum. "The protein-folding problem, 50 years on." science 338.6110 (2012): 1042-1046.
						</cite>
					</div>
					</div>
					<aside class="notes">
						<p>
							<p> Constructing free energy surface is an important problem for many chemical and biology problems</p>
							<p> It contains many important information of the complex system.</p>
							<p>For example, the minimum and the local minima usually represents the stable and metastable state of the system</p>
							<p>FES is also important to some kenitic propeties such as transtion path or energy barrier between two metastable state.</p>
							<p>Usually reconstruct FES is based on the bolzman relation</p>
							<p> It relates the FES with the PDF of finding a particle in a particular state.</p>
							<p>The accurate construction of FES remains a practical challenge due to the high dimensionality and the prevalence of energy barriers</p>
						</p>
					</aside>
				</section>
				<section data-auto-animate>
					<h4>Main Challenges</h4>
					<div style="display: flex; justify-content: center; align-items: center;">

						<div>
							<div data-id="EB">
								<p>
									The Prevalence of Energy Barriers <br>
								</p>
							</div>
							<div data-id="EBP" style="font-size: 0.8em;">
								<p>
									<span style="color: #C82423;"> Explore the phase space by overcoming energy barriers </span> 
								</p>
							</div>
							<div style="font-size: 0.8em;">
								<p>
									<sapn style="color:blue;">Existing Method</sapn>: Umbrella sampling, Histogram reweighting, Metadynamics, Variational enhanced sampling, Temperature-accelerated molecular dynamics
									and Adiabatic free energy dynamics.
								</p>
							</div>
						</div>
						<div>
							<figure>
								<img style="width:1500px; object-fit: cover;" src="./figure/MetaD.png">
							</figure>
						</div>
					</div>
					<aside class="notes">
						<p>The prevalence of energy barriers means the transtion between two metastable states is a rare event.</p>
						<p>The probability of the trasition happens will decrease exponentially with the height of the energy bar.</p>
						<p> Several ingenious methods based on importance sampling have been developed, such as umbrella sampling, histogram reweighting,metadynamics, variational enhanced sampling</p>
						<p> They typically add a bias potential here to increase the probability of transition from one state to the other.</p>
						<p> The finial reconstruction of the FES is based on the PDF estimation under the bias potential</p>
						<p> Another type of method is based on increasing the temperature artificially, the increased the temperature of decrease the energy barrier and increase the probability of transtion happens.</p>
					</aside>
				</section>
				<section data-auto-animate>
					<h4>Main Challenges</h4>
					<div data-id="EB">
						<p>
							The Prevalence of Energy Barriers <br>
						</p>
					</div>
					<div data-id="EBP" style="font-size: 0.8em;">
						<p>
							<span style="color: #C82423;"> Explore the phase space by overcoming energy barriers </span> 
						</p>
					</div>
					<div data-id="HD">
						<br>
						<p>
							The High Dimensionality 
						<sapn style="color:blue;"> (Open) </sapn>
						</p>
					</div>
					<div style="font-size: 0.7em;">
						<p>
							<font color="#C82423"> Exploite the posterior error to adaptively optimize the sampling ponits.</font>
						</p>
					</div>
					<div style="font-size: 0.7em;">
						<p>
							<sapn style="color:blue;">Recent Attempts</sapn>: Reinforce Dynamics (Uncertainty Indicator+ Multi DNN)
						</p>
					</div>
						<aside class="notes">
							<p> Another difficulty of the reconstruct the FES due to the high dimensionality.</p>
							<p> Towards the high dimensional problem, uniformly sampling all over the space can be computational unachiaible.</p>
							<p> A typical idea is add some adaptives in to the sampling, just like adaptive FEM, you may familar.</p>
							<p> The typical idea is use posterior error enhanced sampling</p>
							<p> The numerical method to achieve this in high dimension function approximate is in general open.</p>
							<p> Some recent attemps to this goal.</p>
							<p> In Rid, multi NN is trained on the same data set</p>
							<p> They hope in large error region the different NN will have different value</p>
							<p> Thus the std of the NN can be used to as an indicator to bias the potential.</p>
							<p> In the present work, we want to develop a method achieve both configuration space exploration and posterior error enhanced sampling</p>
						</aside>
				</section>
				<section data-auto-animate>
					<h4>
						Intuitive Idea
					</h4>
					<div data-id="interproduce">
						<div>
								\(\min_{\mathcal{N}}\max_q \int_\Gamma \MLMN(\bz) q(\bz) \intd\bz\) 
						</div>
						<div style="font-size: 0.8em;">
							<ul>
								<li>
									Minization problem:
								</li>
								optimize the FES on the  given sampled points <br>
								<li>
									<sapn style="color:#C82423;"> 	Maximum problem </sapn>:</li>
									 optimize the Sampling Distribution given the trained FES 
								<li>
									<sapn style="color:#C82423;"> Iteratively solving Minization and Maximation problems gives the constructed FES.</sapn>
								</li>
								</ul>
						</div>
						<div>
							<p style="font-size: 0.8em;">
								\(\MLMN(\bz) = \|-\nabla_\bz A_{\mathcal N}(\bz) - \bF(\bz)\|\): Residual Error
								<br>
								\(
								q(\bz)
								\): Sampling Distribution
								<br>
								\(
									A_{\mathcal N}(\bz)
									\):FES Parameterized
								<br>
									\(
									\bF(\bz)
								\):Force Calculated
							</p>
						</div>
					</div>

					<aside class="notes">
						<p> To achieve this goal, we introduce a min-max problem.</p>
						<p> The min problem is common, give some sampling points in the training set, say they satisfies the distribution q</p>
						<p> we ask minize the loss funtion defined as a L2 error of the negative gradient of parameterized FES and force sampled from full dynamics.</p>
						<p> In max problem, give a trained FES, we want to obtain refine our training set or sampling points</p>
						<p> Intuitively, we want to add more points where error is large, thus we maximize the loss with respect the distribution q</p>
					 </aside>
				</section>
				<section data-auto-animate>
					<h4>
						Maximum Problem
					</h4>
						<div>
							<ul>
								<li>
									Original:
								</li>
								\(\max_q \int - \MLMN(\bz)q(\bz) \intd \bz \) <br>
								Solution: \(\delta(\bz-\bz^*)\)
								<p>
								</p>
								<li>
									<sapn style="color:#C82423;">Entropy regularization:</sapn>
								</li>
							    \(
									\min_{q} \int (\MLMN^-(\bz) + \kappa_h \ln q(\bz)) q(\bz) \intd \bz 
									\) <br>
									Solution: \(q^*(\bz)=\exp(-\kappa_h \MLMN^-(\bz))/Z^*\)
							</ul>
						</div>
						<div>
							<sapn style="color:#C82423;"> How to sampling accoding to \(q^*\)?</sapn>
						</div>
						<div>
							<div>
								<small>
									\[
									\begin{aligned}
									& \text{Maximum Error Point}: & \bz^{\ast} &= \arg\max \MLMN(\bz)\\
									&\text{Negative Residual Error}: &\MLMN^-(\bz) & = -\MLMN(\bz)\\
									\end{aligned}
									\]
								</small>
							</div>
						
					</div>
					<aside class="notes">
						<p> The minization problem is relative common, so we focus on the maximum problem first.</p>
						<p> The solution of the maximum problem is delta function localed at the maximum error points.</p>
						<p> However, this task can not be easily achievable, it's a high dimensional no convex optimization problem.</p>
						<p> It's has a strong connection with the difficulty we mentioned before, the high energy bar on the FES</p>
						<p> So typically we want to add some entropy regularization to give our algorithm some exploration ability</p>
						<p> Also we add a minius sign to make maximation to minization.</p>
						<p>The problem is convex for a Probability Density Function (PDF) \( q \), with a unique global minimum.</p> 
						<p> kappa_h works as a </p>
					 </aside>
				</section>
				<section data-auto-animate>
					<h4>
						Local Quaditical Approximation
					</h4>
					<div style="font-size: 0.6em;">
						\[
						\begin{aligned}
						& \MLMN^-(\bz)  & G(\bz) &=\frac{1}{2} (\bz-\mbm)^T V^{-1}(\bz-\mbm)\\
						&q^*(\bz)=\exp(-\kappa_h \MLMN^-(\bz))/Z^* & \tilde{q}(\bz) &= \exp(-\kappa_h G(\bz))/\tilde{Z}
						\end{aligned}
						\]
					</div>
					<div style="display: flex; justify-content: center; align-items: center;">
					<div>
						
						<div data-id="LDT" style="font-size: 0.8em;">
							Based On the Laplace Principle in Large Deviations Theory
						</div>
						<div style="font-size: 0.6em;">
							\[
							\begin{split}
							&\text{First Momentum: } &\mbm = \int \bz p(\bz)\intd \bz  \approx 
							\sum_{i=1}^{N_w} \mb z^i \hat{p}(\mb z^i) \\
							&\text{Second Momentum: } &V  \text{ to be determined} \\
							&\text{Weighted Distribution: } &\hat{p} (\mb z) =  \frac{\exp {(-\kappa_l \MLMN^-(\bz^i))}}{\sum_{i=1}^{N_w}\exp {(-\kappa_l \MLMN^-(\bz^i)})}\\
							 \end{split}
							\]
						</div>
						<sapn style="color:#C82423;">How many \(N_w\) we need?</sapn>

					</div>
					<div>
						<embed src="./figure/Laplaces_method.svg" type="image/svg+xml"/>  
					</div>
				</section>
				<section data-auto-animate>
					<h4>
						Exploitation and Exploration in McKean stochastic differential equation
					</h4>
					<div>
						\[
						\dot{\bz}^i_t = - \frac{1}{\gamma}\nabla_\bz G(\bz^i_t;\mb m_t ,V_t) + \sqrt{\frac{2}{\kappa_h\gamma}} \mathbf\xi_i(t)
						\]
					</div>
						<div style="font-size: 0.6em;">
							\[
							\begin{aligned}
							&\text{Driven Term}: &G(\bz_t;\mb m_t ,V_t) &=\frac{1}{2} (\bz_t-\mbm_t)^T V_t^{-1}(\bz_t-\mbm_t)\\
							&\text{First Momentum} & \mb m_t & = \sum_{i=1}^{N_{w}}\bz^i_t \hat{p}(\bz^i_t),\\
							&\text{Second Momentum} & V_t & = \kappa_t\sum_{i=1}^{N_{w}} (\bz^i_t-\mbm_t)(\bz^i_t-\mbm_t)^T \hat{p}(\bz^i_t)\\
							&\text{Weighted Distribution} & 
							\hat{p} (\mb z) & =  \frac{\exp {(-\kappa_l \MLMN^-(\bz^i))}}{\sum_{i=1}^{N_w}\exp {(-\kappa_l \MLMN^-(\bz^i)})}
							\end{aligned}
							\]
						</div>

					<aside class="notes">
						  <p>Instead we treat the sampler z as a random walker z^i_t, governed by the McKean stochastic differential equation.</p>
						<p>
							The adaptively constructed conservative potential function \( G(\bz_t) \) guides individual particles towards \( \bm_t \), indicative of the region of large residual error. 
						</p> 

					</aside>
				</section>
				

				<section data-auto-animate>
					<div class="proposition" data-id="proposition1">
						<ul>
							<div>Proposition 1:</div>
							<div class="content">
								Suppose \( \mathcal{L}^- (\mathbf{z}) \) takes a local quadratic approximation in the form of \( \frac{1}{2} (\mathbf{z} - \boldsymbol{\mu})^T \Sigma^{-1} (\mathbf{z} - \boldsymbol{\mu}) \), \( q_t \to \frac{\exp{(-\kappa_h \mathcal{L}^- (\mathbf{z}))}}{\int \exp {(-\kappa_h \mathcal{L}^- (\mathbf{z}))} \, d\mathbf{z}} \) as \( t \to \infty \), given \( \kappa_t = \kappa_l + \kappa_h \).
							</div>
						</ul>
					</div>
				</section>

				<section data-auto-animate>
					<h4>
					Numerical Result (2D)
					</h4>
						<div style="display: flex; justify-content: center; align-items: center;">
							<div>
								<small>
								<table>
									<thead>
										<tr>
											<th rowspan="2">Method</th>
											<th colspan="2">Accuracy</th>
											<th colspan="3">Time</th>
										</tr>
										<tr>
											<th>\(l_2\) error</th>
											<th>\(l_\infty\) error</th>
											<th>Simulation</th>
											<th>Train</th>
											<th>Total</th>
										</tr>
									</thead>
									<tbody>
										<tr>
											<td rowspan="2">VES</td>
											<td>5.39</td>
											<td>21.03</td>
											<td colspan="3">47.5</td>
										</tr>
										<tr></tr>
										<tr>
											<td rowspan="2">RiD</td>
											<td>1.52</td>
											<td>9.46</td>
											<td>6.25</td>
											<td>3.79(GPU)</td>
											<td>10.04</td>
										</tr>
										<tr></tr>
										<tr>
											<td rowspan="2">CES</td>
											<td rowspan="2">1.45</td>
											<td rowspan="2">6.74</td>
											<td rowspan="2">0.88 × 10walkers</td>
											<td>0.18(CPU)</td>
											<td>8.98</td>
										</tr>
										<tr>
											<td>0.13(GPU)</td>
											<td>8.93</td>
										</tr>
										<tr></tr>
									</tbody>
								</table>
							</small>
							</div>
						<div
							id=ala2
							class="plotly-graph-div"
							style="height:400; width:400;">
						</div>
						<script type="text/javascript" src="./text/ala2.js">
						</script>
					</div>
				</section>
				<section data-auto-animate>
					<h4>Numerical Result (3D)</h4>
					<div style="display: flex; flex-direction: center; align-items: center;">
						<div>
							<small>
								<table border="1" cellspacing="0" cellpadding="8">
									<thead>
										<tr>
											<th rowspan="2">Method</th>
											<th colspan="3">Time</th>
										</tr>
										<tr>
											<th>Simulation</th>
											<th>Train</th>
											<th>Total</th>
										</tr>
									</thead>
									<tbody>
										<tr>
											<td>RiD</td>
											<td>117</td>
											<td>79 (GPU)</td>
											<td>196</td>
										</tr>
										<tr>
											<td>CES</td>
											<td>4.81× 20walkers</td>
											<td>0.66 (GPU)</td>
											<td>97</td>
										</tr>
									</tbody>
								</table>
							</small>
						</div>
						<div style="overflow-y: auto; max-height: 400px;">
							<div id="chi1_psi_15" class="plotly-graph-div" style="height:500px; width:600px;">
								<small>\(\psi=1.5\)</small>
							</div>
							<div id="chi1_phi_10" class="plotly-graph-div" style="height:500px; width:600px;">
								<small>\(\phi=1.0\)</small>
							</div>
							<div id="chi1_ome_15" class="plotly-graph-div" style="height:500px; width:600px;">
								<small>\(\omega=1.5\)</small>
							</div>
							<script type="text/javascript" src="./text/chi1.js"></script>
						</div>
					</div>
				</section>

				<section data-auto-animate>
					<h4>Numerical Result (30D)</h4>
					<div>
						<div style="overflow-y: auto; max-height: 400px;">
							<div id="phi1_psi1" class="plotly-graph-div" style="height:400px; width:600px; margin: auto;">
								<small>\(\phi_1,\psi_1\)</small>
							</div>
							<div id="phi2_phi3" class="plotly-graph-div" style="height:400px; width:600px; margin: auto;">
								<small>\(\phi_2,\phi_3\)</small>
							</div>
							<div id="psi2_psi3" class="plotly-graph-div" style="height:400px; width:600px; margin: auto;">
								<small>\(\psi_2,\psi_3\)</small>
							</div>
						</div>
						<script type="text/javascript" src="./text/ala16.js"></script>
					</div>
				</section>
				<section data-auto-animate>
					<h4>
						Conclusion
					</h4>
					<div style="font-size: 0.8em;">
						<ul>
							<li>
								The difficulty of construct FES is not only on overcoming energy barrier but also in <font color="#C82423">high dimensionality</font>.
							</li>
							<li>
								We introduce a <font color="#C82423">posterior errors driven </font>sampling process.
							</li>
						</ul>
					</div>
					<div>
						Further Question
					</div>
					<div style="font-size: 0.8em;">
						<ul>
							<li>
								Is the conservative part of FES sufficient to capture the kinetic behavior of CVs?
							</li>
							<li>
								Can the non-conservative part be <font color="#C82423">simplified</font> in the treatment?
							</li>
						</ul>
					</div>
				</section>					
						
				<section data-auto-animate>
					<h4>
						Mori–Zwanzig formalism <font color="#C82423">(General but Impractical)</font>
					</h4>
					<div data-id="MZCG">
						<div class="equation" style="font-size:0.8em;">
							\[ 
							\dot{\mathbf{P}} = \underbrace{-\nabla V(\mathbf{Q})}_{\text{conservative part}} 
							- \underbrace{\int_0^t \mathbf{K}(\mathbf{Q}(s), t-s) \mathbf{V}(s) ds}_{\text{Memory part}} 
							+ \underbrace{\mathbf{R}(t)}_{\text{Random part}} 
							\]

					</div>
					<div style="display: flex; flex-direction: center; align-items: center;">
						<div style="font-size:0.6em; text-align:left;">
							<p>
							The Mori-Zwanzig formalism is perfectly <font color="#C82423">general</font>.
							</p>
							<p>
							In practice, one has to resort to <font color="#C82423">simple</font> approximations.
							</p>
							<p>
								Oversimplication In Conservative part neglect Complexity:\(V(\mathbf{\mb Q_1,\mb Q_2,\cdots})\neq V_1(\mb Q_1)V_2(\mb Q_2) \cdots\)
							</p>
							Oversimplication In Non-Conservative part <span style="color: #C82423;"> undiscovered</span>
						</div>
						<div>
							<svg id="MD1" width="400" height="400"></svg>
							<div>
								<button id="updateValues1">Update</button>
								<script>
									generateAnimation("MD1","updateValues1",3,1);
								</script>
							</div>
						</div>
					</div>
				</section>
				<section data-auto-animate>
					<div data-id="MZCG">
						<div class="equation" style="font-size:0.8em;">
						\[ \dot{\mathbf{P}} = -\nabla V(\mathbf{Q}) - \int_0^t \mathbf{K}(\mathbf{Q}(s), t-s) \mathbf{V}(s) ds   + \mathbf{R}(t) \]
						</div>
					</div>
					<small>
					<div style="display: flex; flex-direction: center; align-items: center;">
						<div style="font-size:0.8em;">
							\[
							\begin{align}
							&\text{M-DPD(Markovian-Pairwise)} \\& \dot{\mb P_i}  = \mb F_i^C - \sum_{j} \mb K(Q_{ij})\mb V_j + \mb R(t).\\
							&\text{NM-GLE(Non Markovian-Isotropic)}\\ & \dot{\mb P} = \mb F^C - \int_0^t \mb K(t-s) \mb V(s) \diff s + \mb R(t).\\
							&\text{NM-DPD(Non Markovian-Pairwise)}\\ & \dot{\mb P}_i =  \mb F^C_{i} - \sum_j \int_0^t \mb K(Q_{ij},t-s) \mb V_{ij}(s) \diff s +  \sum_j\mb R_{ij}(t).\\
							&\color{red}{\text{Our Model}}\\ & \dot{\mb P} =  \mb F^C -  \bm\Xi(\mb Q)\int_0^t {\rm e}^{- \bm\Lambda (t-s)}\bm\Xi(\mb Q)^T \mb V_{ij}(s) \diff s +  \mb R(t),.
							\end{align}
							\]
						</div>
						<div>
							<figure style="margin-left: 5%;">
								<img src="./figure/friction_many.png" style="width:1000px; object-fit: cover;">
							</figure>
						</div>
					</div>

				</small>
				</section>
				

				<section data-auto-animate>
					<div>
						Important Issues
					</div>
					<div style="display: flex; flex-direction: center; align-items: center; font-size: 0.8em">
					<ul>
						The ML model has to
						<li>
							Respect Physics  
						</li> 
						<p>
							Translation, Rotation, <font color="#C82423">Permutation </font> Symmetries <br>
							Second fluctuation-dissipation theorem
						</p>
					</ul>
					<div style="display: flex; justify-content: space-around;">
						<div>
							<svg id="canvas1"></svg>
							<p style="font-size: 20px;">\(\mathbf{\Xi}\)(<span id="input11"></span> , <span id="input12"></span> , <span id="input13"></span>)</p>
							<div class="matrix">
							<table style="font-size: 20px;">
								<tr>
									<td>&Xi;<span id="gamma111"><sub>1</sub></span><span id="gamma112"><sub>1</sub></span></td>
									<td>&Xi;<span id="gamma113"><sub>1</sub></span><span id="gamma121"><sub>2</sub></span></td>
									<td>&Xi;<span id="gamma114"><sub>1</sub></span><span id="gamma131"><sub>3</sub></span></td>
								</tr>
								<tr>
									<td>&Xi;<span id="gamma122"><sub>2</sub></span><span id="gamma115"><sub>1</sub></span></td>
									<td>&Xi;<span id="gamma123"><sub>2</sub></span><span id="gamma125"><sub>2</sub></span></td>
									<td>&Xi;<span id="gamma124"><sub>2</sub></span><span id="gamma132"><sub>3</sub></span></td>
								</tr>
								<tr>
									<td>&Xi;<span id="gamma133"><sub>3</sub></span><span id="gamma116"><sub>1</sub></span></td>
									<td>&Xi;<span id="gamma134"><sub>3</sub></span><span id="gamma126"><sub>2</sub></span></td>
									<td>&Xi;<span id="gamma135"><sub>3</sub></span><span id="gamma136"><sub>3</sub></span></td>
								</tr>
								<tr>
								</tr>
							</table>
						</div>
							<button id="clearButton1">Clear</button>
						</div>
						<div>
						<svg id="canvas2"></svg>
						<p style="font-size: 20px;">\(\mathbf{\Xi}\)(<span id="input21"></span> , <span id="input22"></span> , <span id="input23"></span>)</p>
						<div class="matrix">
							<table style="font-size: 20px;">
								<tr>
									<td>&Xi;<span id="gamma211"><sub>1</sub></span><span id="gamma212"><sub>1</sub></span></td>
									<td>&Xi;<span id="gamma213"><sub>1</sub></span><span id="gamma221"><sub>2</sub></span></td>
									<td>&Xi;<span id="gamma214"><sub>1</sub></span><span id="gamma231"><sub>3</sub></span></td>
								</tr>
								<tr>
									<td>&Xi;<span id="gamma222"><sub>2</sub></span><span id="gamma215"><sub>1</sub></span></td>
									<td>&Xi;<span id="gamma223"><sub>2</sub></span><span id="gamma225"><sub>2</sub></span></td>
									<td>&Xi;<span id="gamma224"><sub>2</sub></span><span id="gamma232"><sub>3</sub></span></td>
								</tr>
								<tr>
									<td>&Xi;<span id="gamma233"><sub>3</sub></span><span id="gamma216"><sub>1</sub></span></td>
									<td>&Xi;<span id="gamma234"><sub>3</sub></span><span id="gamma226"><sub>2</sub></span></td>
									<td>&Xi;<span id="gamma235"><sub>3</sub></span><span id="gamma236"><sub>3</sub></span></td>
								</tr>
								<tr>
								</tr>
							</table>
						</div>
						<button id="clearButton2">Clear</button>
						</div>
						<script src="./figure/permutation.js"></script>
					</div>
					</div>
				</section>
					<section data-auto-animate>
						<div>
							Important Issues
						</div>
						<div style="display: flex; flex-direction: center; align-items: center; font-size: 0.8em">
						<div>
							<ul>
								The ML model has to
								<li>
									Respect Physics  
								</li> 
								<p>
									Translation, Rotation, <font color="#C82423">Permutation </font> Symmetries <br>
									Second fluctuation-dissipation theorem
								</p>
								<li>
									<font color="#C82423">Extensive</font>
								</li>
							</ul>
								<svg id="MD2" width="200" height="200"> </svg>
								<div>
								<button id="updateValues2">Update</button>
									<script>
										generateAnimation("MD2","updateValues2",3,0.5);
									</script>
								</div>
						</div>
						<div>
						<svg id="MD3" width="400" height="400"> </svg>
							<button id="updateValues3">Update</button>
							<script>
								generateAnimation("MD3","updateValues3",12,0.5);
							</script>
						</div>
					
						</div>
				</section>
				<section data-auto-animate>
					<div style="display: flex; align-items: center;">
						<!-- SVG and Button Container -->
						<div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
							<figure>
								<p><img src="./figure/Q.png">
							</figure>
							<figure>
								<p><img src="./figure/hatQ.png">
							</figure>
						</div>
						<div>
							\( \hat{ \mathbf Q}^k_i = \mathbf{Q}_i \oplus \sum_{l\in\mathcal{N}_i} f^k(|\mathbf{Q}_{il}|) \mathbf{Q}_{il} \) <br> 
							\( \hat{\mathbf{Q}}_{ij}^{k} = \hat{\mathbf{Q}}_i^{k} - \hat{\mathbf{Q}}_j^{k} \)  <br>
							\(\boldsymbol{\Xi}^n_{ij} = \sum_{k=1}^K h_{n,k}(\hat{ \mathbf Q}_{ij}^T \hat{ \mathbf Q}_{ij} ) \hat{ \mathbf Q}_{ij}^k \otimes \hat{ \mathbf Q}_{ij}^k\)
						</div>
						<aside class="notes">
							For each molecule, we construct an environment-embedded coordinate. Here, Q_ij represents the distance vector between each pair of molecules. By utilizing the coordinates of particles within the cutoff distance of the central coordinate, we determine K general coordinates. Specifically, f acts as a network, and Qij is the distance vector of the central vector. By applying some nonlinear activation to the original coordinate, we obtain a general coordinate that is symmetric in R3K.
							</aside>
				</section>
				  <section data-auto-animate data-menu-title="VACF">
					<div style="display: flex; justify-content: center; align-items: center;">
						<div>
							<h5>
								Velocity auto correlation function (VACF)
							</h5>
							<p>
								<small>
									\[ \frac{\lt v_i(t) \cdot v_i(0) \gt }{ \lt v_i(0) \cdot v_i(0) \gt } \]
								</small>
							</p>
						</div>

						<div
							id=vacf
							class="plotly-graph-div"
							style="height:400; width:400;">
						</div>
						<script type="text/javascript" src="./text/vacf.js">
						</script>
					</div>
					<aside class="notes">
						Next, we’re exploring isotropic dynamic properties, such as the Velocity Auto Correlation Function (VACF), which measures the time correlation of a particle's velocity. Notice how our model, marked as NM-MB (red), and the state-independent GLE (purple) are spot on! This is because the GLE model uses the memory kernel as a free parameter to fit the VACF. As Von Neumann said, with four free parameters, one can draw an elephant! It’s not surprising, but it doesn’t mean GLE can recover the dynamics accurately.
						</aside>
					</section>
					<section data-auto-animate data-menu-title="VCCF">
						<div style="display: flex; justify-content: center; align-items: center;">
							<div>
								<h5>
									Velocity cross correlation function (VCCF)
								</h5>
								<p>
								<small>
									\[ C^{xx}(t; r_0) = \mathbb{E}[\mathbf{V}_i(0)\cdot\mathbf{V}_j(t) \vert Q_{ij}(0) = r_0] \]
								</small>
								</p>
							</div>
							<div
								id=vccf
								class="plotly-graph-div"
								style="height:400; width:400;">
							</div>
							<script type="text/javascript" src="./text/vccf.js">
							</script>
						</div>
						<aside class="notes">
							If we delve deeper into metrics like the Velocity Cross Correlation Function (VCCF), which represents the momentum transfer rate at a fixed distance, we see that GLE falls short, but our model still captures the main contribution. It’s also worth noting that NM-DPD shows decent results, but that’s because it uses VCCF as a fitting target.
							</aside>
					</section>
					<section data-auto-animate data-menu-title="VHF">
						<div style="display: flex; justify-content: center; align-items: center;">
							<div>
								<h5>
									van Hove function (VHF)
								</h5>
								<p>
									<small>
									\( G(r, t) \propto \frac{1}{M^2} \sum_{j\neq i}^M \delta(\Vert \mathbf{Q}_i(t) - \mathbf{Q}_j(0)\Vert - r) \).
								</small>
									</p>
							</div>
							<div
								id=vhf
								class="plotly-graph-div"
								style="height:400; width:400;">
							</div>
							<script type="text/javascript" src="./text/vhf.js">
							</script>
						</div>
						<aside class="notes">
							Let’s look at another property, the van Hove Function (VHF), which is essentially a time evolution of the RDF. It measures the probability of finding a particle at time t with distance r from the central particle. Here, both NM-DPD and NM-GLE fall short, but our model stands strong!
							</aside>
					</section>
					<section data-auto-animate data-menu-title="Hydromode">
						<div style="display: flex; justify-content: center; align-items: center;">
							<div>
								<h5>
									normalized correlations of the Longitudinal Hydrodynamic Modes
									<!-- normalized correlations of the longitudinal and transverse hydrodynamic modes -->
								</h5>
								<p>
								<small>
									\[ 
									\begin{split}
									C_L(t) &= \langle \tilde{u}_1(t)\tilde{u}_1(0)\rangle \\
									\tilde{\mb u} &= 1/M\sum_{j=1}^M \mb V_j {\rm e}^{i\mb k \cdot \mb Q_j}
									\end{split}
									\]
								</small>
								</p>
							</div>
							<div
								id=long_corr
								class="plotly-graph-div"
								style="height:400; width:400;">
							</div>
							<script type="text/javascript" src="./text/long_corr.js">
							</script>
							<aside class="notes">
								We can also explore the correlation of wave propagation modes, which represent the coefficients of the linearized NV equation in the spectrum domain. In the longitudinal direction, both NM-DPD and our model perform well, as the conservative term mainly contributes in this direction.
								</aside>
					</section>
					<section data-auto-animate data-menu-title="Hydromode">
						<div style="display: flex; justify-content: center; align-items: center;">
							<div>
								<h5>
									normalized correlations of the Transverse Hydrodynamic Modes
									<!-- normalized correlations of the longitudinal and transverse hydrodynamic modes -->
								</h5>
								<p>
								<small>
									\[ 
									\begin{split}
									C_L(t) &= \langle \tilde{u}_2(t)\tilde{u}_2(0)\rangle \\
									\tilde{\mb u} &= 1/M\sum_{j=1}^M \mb V_j {\rm e}^{i\mb k \cdot \mb Q_j}
									\end{split}
									\]
								</small>
								</p>
							</div>
							<div
								id=trans_corr
								class="plotly-graph-div"
								style="height:400; width:400;">
							</div>
							<script type="text/javascript" src="./text/trans_corr.js">
							</script>
							<aside class="notes">
								However, when it comes to the transverse term, our model clearly outshines the others.
								</aside>
					</section>

					<section>
						<h4>
							<div style="display:inline">
								Multi-scale modeling:
							</div> 
							<div style="display:inline">
								Background 
							</div>
						</h4>
						<svg id="mySVG" width="1000" height="600">
							<!-- Draw x and y axes -->
							<line x1="50" y1="550" x2="950" y2="550" style="stroke:black;stroke-width:2" />
							<line x1="50" y1="550" x2="50" y2="50" style="stroke:black;stroke-width:2" />
							<defs>
								<marker id="arrowhead" markerWidth="5" markerHeight="3.5" 
								refX="0" refY="1.75" orient="auto">
									<polygon points="0 0, 5 1.75, 0 3.5" fill="rgb(130, 176, 210)" stroke="rgb(130, 176, 210)" />
								</marker>
							</defs>
							<line id="line_ms" x1="400" y1="450" x2="750" y2="225" stroke="rgb(130, 176, 210)" stroke-width="5" 
							marker-end="url(#arrowhead)" />
							<text id="text_ms" x="525" y="375" font-size="20" fill="rgb(130, 176, 210)" 
							style="text-shadow: 2px 2px 4px rgba(150, 150, 150, 0.5);"
							transform="translate(525,375) rotate(-34) translate(-525,-375)"
							>
								<tspan x="525" dy="1.2em">bottom-up /ab initio </tspan>
								<tspan x="525" dy="1.2em">multi-scale modeling</tspan>
							</text>
							<line id="line_mi_me" x1="50" y1="275" x2="300" y2="275" style="stroke:rgb(87,66,102);stroke-width:3; stroke-dasharray: 5 5;" />
							<line id="line_me_ma" x1="50" y1="125" x2="500" y2="125" style="stroke:rgb(87,66,102);stroke-width:3; stroke-dasharray: 5 5;" />
							<text id="text_mi" x="60" y="375" font-size="25" fill="rgb(87,66,102)" 
							>
								microscopic
							</text>
							<text id="text_me" x="60" y="200" font-size="25" fill="rgb(87,66,102)" 
							>
								mesoscopic
							</text>
							<text id="text_ma" x="60" y="80" font-size="25" fill="rgb(87,66,102)" 
							>
								macroscopic
							</text>
						</svg>
						<script src="./figure/multiscale.js">
						</script>
						<aside class="notes">
							Reduced models are opening up new possibilities, trimming down degrees of freedom by omitting specific details, paving the way for larger scale simulations. For instance, 
							in Molecular Dynamics (MD), the focus is solely on the positions of atoms, leaving out electrons. 
							In Coarse-Grained Molecular Dynamics (CGMD), only collective variables are resolved. 
							And in macroscale models, like Euler equations and Navier–Stokes (NV) equations, 
							the Eulerian viewpoint is focus on density, velocity, and so forth as functions of time and spatial.
							<br>
							However, these reduced models are typically derived empirically – it’s a lot of educated guessing! Making the right guess can often require and represent some serious physical insight. <br>
							<br>
							Take, for example, the force field in MD, the friction term in CGMD, the closed forms in macro models, or the collision term in kinetic theory.
							<br>
							Even in Quantum Mechanics (QM), some level of guessing is needed, whether it’s for the many-body wavefunction in Quantum Monte Carlo (QMC) or the exchange-correlation function in Density Functional Theory (DFT).
							<br>
						</aside>
					</section>

						<section data-auto-animate>
							<h4>Coarse-Graining Variable Optimization</h4>
							<aside class="notes">
								<p>Let’s delve into the intricacies, not just limited to dynamic equations, but extending to the selection of dynamic coordinates. Consider water models as a prime example. We have various coordinates, ranging from one to six, each designed to represent water and capture distinct behaviors. The careful selection of these coordinates is deeply rooted in physical insight, akin to the model-building we’ve discussed earlier.</p>
								<p>As we navigate through the complexity of molecular structures, this task becomes increasingly challenging. Here, the prospect of data-driven coordinate selection emerges as a potential alternative to the traditional approach, which is predominantly reliant on human intelligence.</p>
								<p>In the realm of extensive CGMD systems, the center of mass (COM) takes center stage. However, when it comes to modeling non-Newtonian fluids, known for their complex flow behavior, accurately capturing the deformation of polymers is essential. This crucial aspect is often oversimplified when the focus is solely on COM. Therefore, our ongoing project aims to underscore the significance of dynamic coordinate selection in faithfully depicting macroscopic rheology behavior.</p>
							</aside>
						</section>
					</section>
					<section data-auto-animate>
						<h4>Coarse-Graining Variable Optimization</h4>
						<div data-id="allmap">
						\[
						\begin{split}
						\phi(\mathbf{z}) &= \left[\phi^Q (\mathbf{q}), \phi^P (\mathbf{p})\right] \\
						\phi &: \mathbb{R}^{6nM} \to \mathbb{R}^{6NM}
						\end{split}
						\]
						</div>
						<aside class="notes">
							<p>For simplicity, let’s switch up our notation a bit. Imagine we have a full MD system made up of \( M \) molecules, each containing \( n \) atoms. To make things straightforward, we'll assume the mass of each is \( 1 \).</p>
							<p>We represent the CG variables by associating each molecule with \( N \) CG particles.</p>
						</aside>
					</section>
					<section data-auto-animate>
						<h4>Coarse-Graining Variable Optimization</h4>
						<div data-id="allmap" >
							\[
							\begin{split}
							\phi(\mathbf{z}) &= \left[\phi^Q (\mathbf{q}), \phi^P (\mathbf{p})\right] \\
							\phi &: \mathbb{R}^{6nM} \to \mathbb{R}^{6NM}
							\end{split}
							\]
							</div>
						<div>
						\[
						\begin{split}
						\phi &=\otimes^M\hat{\phi} \\
						\hat{\phi} &: \mathbb{R}^{6n} \to \mathbb{R}^{6N}
						\end{split}
						\]
						</div>
						<aside class="notes">
							<p>Let’s say the CG variable is figured out based on what’s going on inside the molecule. So, we can use a direct product formula to represent it, making our lives a bit easier!</p>
						 </aside>
						 
						
					</section>
					<section data-auto-animate>
						<p>In this project, we assume that the coarse-grained map is defined by a matrix \( W \in \mathbb{R}^{N\times n} \). We desire that \( W \) satisfies several properties:</p>
						<ul>
							<li>Each element \( w_{ij} \) of the matrix \( W \) is in the interval \([0,1]\).</li>
							<li>The sum of the elements in each column of \( W \) is 1, i.e., \( \sum_i w_{ij} =1 \).</li>
						</ul>
						<aside class="notes">
							<p>We’re also assuming the CG variables are linear and can be figured out by a matrix W, which has a few properties we need to keep in mind…</p>
							<p> 
								The second property make sure we can still used the Netwon's thrid law rather than deal with diagnoal term separately
							</p>
						</aside>
					</section>

					<section data-auto-animate>
						The CG map is thus defined as:
					\[
					\begin{split}
					\hat{\phi}^Q_W(\mathbf{z}^I) &= \frac{\sum_{j} w_{ij} \mathbf{q}^I_j}{\sum_j w_{ij}}\\
					\hat{\phi}^P_W(\mathbf{z}^I) &= \sum_{j} w_{ij} \mathbf{p}^I_j;
					\end{split}
					\]
					<aside class="notes">
						<p>So, this is how we define the CG map based on W</p>
					 </aside>
					 
					</section>
					<section data-auto-animate>
						<h4>
							Maximum Rayleigh quotient to obtain CG variable
						</h4>
					</section>
					<aside class="notes">
						<p>Next, we address the determination of the matrix W through an optimization problem.</p>
					 </aside>
					<section data-auto-animate>
						<h4>
							Maximum Rayleigh quotient to obtain CG variable
						</h4>
						<div data-id="liu">
							\[
							\mathbf{\phi}_W(\mathbf{z}(t)) = {\rm e}^{\mathcal{L} t}\phi_W(\mathbf{z}(0))
							\]
						</div>
						<aside class="notes">
							<p>The temporal evolution of the CG variable is characterized by a Liouville operator.</p>
						 </aside>
					</section>
					<section data-auto-animate>
						<h4>
							Maximum Rayleigh quotient to obtain CG variable
						</h4>
						<div data-id="liu">
							\[
							\mathbf{\phi}_W(\mathbf{z}(t)) = {\rm e}^{\mathcal{L} t}\phi_W(\mathbf{z}(0))
							\]
						</div>
						<div>
							\[
							\max_W \frac{\phi_W(\mb z(0)){\rm e}^{\mathcal{L} t}\phi_W(\mathbf{z}(0))}{\phi_W(\mathbf{z}(0)) \phi_W(\mathbf{z}(0))}
							\]
						</div>
						<aside class="notes">
							<p>The slowest mode of the Liouville operator can be discerned utilizing the Maximum Rayleigh quotient. This is intrinsically related to the auto-correlation function previously discussed. In practice, we employ VACF exclusively and opt for a time domain rather than a specific time.</p>
						 </aside>
					</section>
					<section data-auto-animate>
						<h4>
							1D Reverse Poiseuille Flow
						</h4>
						<div style="display: flex; justify-content: center; align-items: center;">
						<div>
							<figure>
								<p><img src="./figure/res_flow.png" style="width: 50%; height: 50%;"></p>
							</figure>
						</div>
						</div>
						<aside class="notes">
							<p>We apply our methodology to a reverse Poiseuille flow. By dividing the domain in the z direction, a reverse force is applied in the opposite direction along the x-axis, resulting in a distinct velocity profile in the x component of the average velocity in the z direction.</p>
						 </aside>
					</section>
					<section data-auto-animate data-menu-title="VHF">
						<h4>
							1D Reverse Poiseuille Flow
						</h4>
						<div style="display: flex; justify-content: center; align-items: center;">
						<div>
							<figure>
								<p><img src="./figure/res_flow.png" ></p>
							</figure>
						</div>
						<div style="display: flex; justify-content: center; align-items: center;">
							<div
								id=vx
								class="plotly-graph-div"
								style="height:300; width:300;">
							</div>
							<script type="text/javascript" src="./text/vx.js">
							</script>
						</div>
						
						</div>
						<aside class="notes">
							<p>During this process, the deformation of the polymer is intertwined with fluid flow, exhibiting rheological behavior. It is demonstrable that with additive CG, we are able to capture these contributions, which are oversimplified by COM.</p>
						 </aside>
					</section>
				</div>
		</div>
		
		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,
				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
			});
		</script>
		<script src="node_modules/reveal.js-menu/menu.js"></script>
		<script>
			Reveal.initialize({
			slideNumber: 'c/t',
			plugins: [ RevealMenu ],
			titleSelector: '',
			menu: {
				titleSelector: 'h1, h2, h3, h4', 
				hideMissingTitles: true
			}
		});
		</script>
	</body>
</html>